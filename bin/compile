#!/usr/bin/env bash
# bin/compile <build-dir> <cache-dir>

# fail fast
set -e

# parse args
BUILD_DIR=$1
CACHE_DIR=$2

curl --silent --location http://git-core.googlecode.com/files/git-1.7.11.5.tar.gz | tar xz

cd git-1.7.11.5

mkdir $BUILD_DIR/local
mkdir $BUILD_DIR/local/bin

echo "-----> Building Git..."
NO_TCLTK=YesPlease NO_PERL=YesPlease NO_GETTEXT=YesPlease NO_SVN_TESTS=YesPlease NO_MSGFMT_EXTENDED_OPTIONS=YesPlease make prefix=$BUILD_DIR/local/bin all
echo "       done"

echo "-----> Installing Git..."
make prefix=$BUILD_DIR/local/bin install
echo "       done."

PATH=$HOME/local/bin:$PATH